<!doctype html>
<html lang="en" data-bs-theme="dark">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<link
			rel="stylesheet"
			href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css"
		/>
		<link rel="stylesheet" href="/static/css/app.css">
		<script src="https://unpkg.com/htmx.org@1.9.12"></script>
		<title>GoMarket</title>
	</head>
	<body class="min-vh-100 d-flex flex-column">
		<nav class="navbar navbar-expand-lg bg-body-tertiary">
			<div class="container-fluid">
				<a
					class="navbar-brand"
					href="/"
					hx-get="/"
					hx-target="#app"
					hx-swap="innerHTML"
					hx-push-url="true"
					>GoMarket</a
				>

				<button
					class="navbar-toggler"
					type="button"
					data-bs-toggle="collapse"
					data-bs-target="#navbarNav"
					aria-controls="navbarNav"
					aria-expanded="false"
					aria-label="Toggle navigation"
				>
					<span class="navbar-toggler-icon"></span>
				</button>

				<div class="collapse navbar-collapse w-100" id="navbarNav">
					<!-- LEFT (1st two texts: Navbar brand + Home) -->
					<ul class="navbar-nav me-auto mb-2 mb-lg-0"></ul>
					{{if .IsLoggedIn}}
					<ul class="navbar-nav mx-auto mb-2 mb-lg-0">
						<li class="nav-item">
							<a
								class="nav-link"
								href="/search"
								hx-get="/search"
								hx-target="#app"
								hx-swap="innerHTML"
								hx-push-url="true"
								>Search</a
							>
						</li>
						<li class="nav-item">
							<a
								class="nav-link"
								href="/alerts"
								hx-get="/alerts"
								hx-target="#app"
								hx-swap="innerHTML"
								hx-push-url="true"
								>Alerts</a
							>
						</li>
						<li class="nav-item">
							<a
								class="nav-link"
								href="/portfolio"
								hx-get="/portfolio"
								hx-target="#app"
								hx-swap="innerHTML"
								hx-push-url="true"
								>Portfolio</a
							>
						</li>
					</ul>
					<ul class="navbar-nav ms-auto mb-2 mb-lg-0">
						<li class="nav-item dropdown">
							<a
								class="nav-link dropdown-toggle"
								href="#"
								role="button"
								data-bs-toggle="dropdown"
								aria-expanded="false"
							>
								{{.user.FirstName}}
							</a>
							<ul class="dropdown-menu dropdown-menu-end">
								<li>
									<a
										class="dropdown-item"
										href="/funds"
										hx-get="/funds"
										hx-target="#fundsModal"
										hx-swap="innerHTML"
										hx-push-url="true"
										>Deposit Funds</a
									>
								</li>
								<li>
									<a
										class="dropdown-item"
										href="/settings"
										hx-get="/settings"
										hx-target="#app"
										hx-swap="innerHTML"
										hx-push-url="true"
										>Settings</a
									>
								</li>

								<li>
									<a
										class="dropdown-item"
										href="/logout"
										hx-get="/logout"
										hx-target="#app"
										hx-swap="innerHTML"
										hx-push-url="true"
										>Logout</a
									>
								</li>
							</ul>
						</li>
					</ul>
					{{else}}
					<ul class="navbar-nav ms-auto mb-2 mb-lg-0">
						<li class="nav-item">
							<a
								class="nav-link"
								href="/login"
								hx-get="/login"
								hx-target="#app"
								hx-swap="innerHTML"
								hx-push-url="true"
								>Login</a
							>
						</li>
						<li class="nav-item">
							<a
								class="nav-link"
								href="/register"
								hx-get="/register"
								hx-target="#app"
								hx-swap="innerHTML"
								hx-push-url="true"
								>Register</a
							>
						</li>
					</ul>
					{{end}}
				</div>
			</div>
		</nav>
		<main
			id="app"
			class="flex-grow-1 d-flex p-0"
			hx-get="{{ .InitialPath }}"
			hx-trigger="load"
			hx-swap="innerHTML"
		></main>
		<div
			class="modal fade"
			id="staticBackdrop"
			data-bs-backdrop="static"
			data-bs-keyboard="false"
			tabindex="-1"
			aria-labelledby="staticBackdropLabel"
			aria-hidden="true"
		>
			<!-- HTMX will swap the dialog/content in here -->
			<div
				id="fundsModalContent"
				hx-on::after-swap="bootstrap.Modal.getOrCreateInstance(document.getElementById('staticBackdrop')).show()"
			></div>
		</div>
		<footer class="mt-auto py-3 border-top text-center">
			<div class="container text-muted">Â© 2026 GoMarket</div>
		</footer>
		<script
			src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
			integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
			crossorigin="anonymous"
		></script>
		<script
			defer
			src="https://unpkg.com/lightweight-charts@4.2.3/dist/lightweight-charts.standalone.production.js"
		></script>
		<script defer src="/static/js/chartData.js"></script>
	</body>
</html>
